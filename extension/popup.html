<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=380, initial-scale=1.0, user-scalable=no">
  <title>Real Focus Assistant</title>
  <link rel="stylesheet" href="popup.css">
  <style>
    html, body {
      width: 600px !important;
      height: 440px !important;
      margin: 0 !important;
      padding: 0 !important;
      overflow-x: hidden !important;
    }
  </style>
</head>
<body>
  <!-- Frame 1: Input State -->
  <div id="input-state" class="state-container">
    <div class="input-panel">
      <h2 class="question-text">What are you focusing on?</h2>
      <input 
        type="text" 
        id="keywordsInput" 
        class="keyword-input" 
        placeholder="e.g. using figma to design a prototype"
      >
      <p class="hint-text">P.S. The more adequate the details, the more precise the Focus Assistant's judgment.</p>
      <button id="startButton" class="start-button">Start Focus</button>
    </div>
  </div>

  <!-- Frame 2: Focused State -->
  <div id="focused-state" class="state-container hidden">
    <!-- Loading Indicator -->
    <div id="loading-indicator" class="loading-indicator hidden">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading...</p>
    </div>
    <div class="focused-panel">
      <!-- Top Section: Subject -->
      <div class="subject-top-section">
        <label class="section-label">Subject</label>
        <div class="subject-display">
          <input 
            type="text" 
            id="subjectDisplay" 
            class="subject-input" 
            value="using figma to design a prototype"
            placeholder="e.g. using figma to design a prototype"
          >
          <button id="editSubjectButton" class="edit-button" aria-label="Edit subject">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Main Content: Two Columns -->
      <div class="main-content-grid">
        <!-- Left Column: Pomodoro Timer -->
        <div class="content-block timer-block">
          <!-- Status Title
          <div id="timerStatusTitle" class="timer-status-title">Focusing</div> -->
          
          <!-- Large Countdown Display -->
          <div class="countdown-section-large">
            <!-- Pomodoro Cycle Indicator -->
            <div id="pomodoroCycleIndicator" class="pomodoro-cycle-indicator">
              <span class="tomato-emoji" id="tomato0">üçÖ</span>
              <span class="tomato-emoji" id="tomato1">üçÖ</span>
              <span class="tomato-emoji" id="tomato2">üçÖ</span>
              <span class="tomato-emoji" id="tomato3">üçÖ</span>
            </div>  
            <div id="countdownDisplay" class="countdown-display-large">
              <svg class="countdown-progress-svg" viewBox="0 0 100 100">
                <!-- Background circle (inner circle) -->
                <circle
                  class="countdown-bg-circle"
                  cx="50"
                  cy="50"
                  r="45"
                  fill="none"
                  stroke="#E0E0E0"
                  stroke-width="2"
                />
                <!-- Progress circle (outer circle) -->
                <circle
                  id="countdownProgressCircle"
                  class="countdown-progress-circle"
                  cx="50"
                  cy="50"
                  r="48"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="3"
                  stroke-linecap="round"
                  transform="rotate(-90 50 50)"
                />
              </svg>
              <!-- Countdown text (shown when timer is running) -->
              <span id="countdownText" class="countdown-text">25:00</span>
              <!-- Duration picker (shown when stopped/paused, clickable to change duration) -->
              <div id="durationPickerContainer" class="duration-picker-container-inline hidden">
                <div class="duration-picker-wrapper-inline">
                  <div class="duration-picker-mask-inline"></div>
                  <div id="durationPicker" class="duration-picker-inline">
                    <div class="duration-option" data-minutes="5">05:00</div>
                    <div class="duration-option" data-minutes="15">15:00</div>
                    <div class="duration-option" data-minutes="25">25:00</div>
                    <div class="duration-option" data-minutes="30">30:00</div>
                    <div class="duration-option" data-minutes="45">45:00</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons Wrapper -->
          <div class="timer-actions-wrapper">
            <!-- Action Buttons (FOCUS session) -->
            <div id="focusActions" class="action-buttons">
              <button id="pauseFocusButton" class="action-button action-button-filled">Pause</button>
            </div>
            
            <!-- Action Buttons (BREAK session) -->
            <div id="breakActions" class="action-buttons hidden">
              <button id="doneBreakButton" class="action-button action-button-filled">Done</button>
            </div>
            
            <!-- Action Buttons (STOPPED state) -->
            <div id="stoppedActions" class="action-buttons hidden">
              <button id="startToFocusButton" class="action-button action-button-filled">Start to Focus</button>
            </div>
            
            <!-- Action Buttons (PAUSED state) -->
            <div id="pausedActions" class="action-buttons hidden">
              <button id="resumeFocusButton" class="action-button action-button-filled">Continue</button>
              <button id="stopFocusButton" class="action-button action-button-outlined">Stop</button>
            </div>
          </div>
        </div>

        <!-- Right Column: Site Relevance -->
        <div class="content-block site-block">
          <div class="site-section">
            <label class="section-label">Current site</label>
            <div id="currentSiteDisplay" class="site-url">www.xiaohongshu.com/sjkdfej/dfd</div>
          </div>
          
          <div class="relevance-section">
            <label class="section-label">Relevant</label>
            <div id="relevanceScoreDisplay" class="score-display score-high">85%</div>
          </div>
          
          <div class="status-section">
            <label class="section-label">Status</label>
            <div id="statusDisplay" class="status-display status-stay">Stay</div>
          </div>

          <!-- Divider -->
          <div class="section-divider"></div>

          <!-- Bottom Section: Statistics -->
          <div class="stats-section">
            <div class="stat-item">
              <label class="stat-label">Focus time of today</label>
              <div id="todayFocusTime" class="stat-value">13m</div>
            </div>
            <div class="stat-item">
              <label class="stat-label">Distractions blocked</label>
              <div id="blockedCount" class="stat-value">255 times</div>
            </div>
          </div>
        </div>
      </div>
      

    </div>
  </div>


  <!-- Module scripts (load in order) -->
  <script src="time-utils.js"></script>
  <script src="storage-utils.js"></script>
  <script src="ui-manager.js"></script>
  <script src="event-handlers.js"></script>
  <!-- Main entry point -->
  <script src="popup.js"></script>
</body>
</html>

